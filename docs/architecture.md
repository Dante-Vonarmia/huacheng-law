# åè¯šå¾‹å¸ˆäº‹åŠ¡æ‰€é—¨æˆ· - é¡¹ç›®æ¶æ„æ–‡æ¡£

**é¡¹ç›®**: Watson & Band Law Firm Portal Revamp
**æ¶æ„ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¥æœŸ**: 2025-11-03

---

## 1. æ¶æ„æ¦‚è§ˆ

### 1.1 ç³»ç»Ÿå®šä½
åè¯šå¾‹å¸ˆäº‹åŠ¡æ‰€é—¨æˆ·ç½‘ç«™æ˜¯ä¸€ä¸ª**å†…å®¹å±•ç¤ºå‹é—¨æˆ·ç³»ç»Ÿ**ï¼Œä¸»è¦åŠŸèƒ½ä¸ºï¼š
- å±•ç¤ºå¾‹æ‰€ä¿¡æ¯ï¼ˆä¸šåŠ¡é¢†åŸŸã€å¾‹å¸ˆå›¢é˜Ÿã€æ–°é—»åŠ¨æ€ï¼‰
- æä¾›å¤šè¯­è¨€æ”¯æŒï¼ˆä¸­æ–‡ / Englishï¼‰
- æ¥æ”¶ç”¨æˆ·å’¨è¯¢ï¼ˆè”ç³»è¡¨å•ã€æ´»åŠ¨æŠ¥åï¼‰
- æä¾›å…¨ç«™æœç´¢åŠŸèƒ½

### 1.2 æŠ€æœ¯æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç”¨æˆ·æµè§ˆå™¨                            â”‚
â”‚              (Desktop / Tablet / Mobile)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ HTTPS
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SvelteKit Frontend                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SSG Pages   â”‚  â”‚  SSR Pages   â”‚  â”‚  CSR Parts   â”‚  â”‚
â”‚  â”‚  (Static)    â”‚  â”‚  (Dynamic)   â”‚  â”‚  (Interact)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              UI Kit Components                    â”‚  â”‚
â”‚  â”‚     (Hero / Card / Footer / Navigation)          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ REST API
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Adapter Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           schema-map.json (å­—æ®µæ˜ å°„)              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           API Client (æ¥å£å°è£…)                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ HTTP/HTTPS
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Backend API (æ—§ç³»ç»Ÿ)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Lawyers    â”‚  â”‚     News     â”‚  â”‚   Practices  â”‚  â”‚
â”‚  â”‚     API      â”‚  â”‚     API      â”‚  â”‚     API      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    Events    â”‚  â”‚   Contact    â”‚  â”‚    Search    â”‚  â”‚
â”‚  â”‚     API      â”‚  â”‚     API      â”‚  â”‚     API      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ç›®å½•ç»“æ„è§„èŒƒ

```
huacheng-law/
â”‚
â”œâ”€â”€ CLAUDE.md                     # é¡¹ç›®å®šä¹‰æ–‡ä»¶
â”œâ”€â”€ AGENTS.md                     # Agent é…ç½®æ–‡ä»¶
â”œâ”€â”€ TASKS.md                      # ä»»åŠ¡æ³¨å†Œè¡¨
â”œâ”€â”€ package.json                  # ä¾èµ–ç®¡ç†
â”œâ”€â”€ tsconfig.json                 # TypeScript é…ç½®
â”œâ”€â”€ svelte.config.js              # SvelteKit é…ç½®
â”œâ”€â”€ vite.config.ts                # Vite é…ç½®
â”œâ”€â”€ .eslintrc.js                  # ESLint é…ç½®
â”œâ”€â”€ .prettierrc                   # Prettier é…ç½®
â”‚
â”œâ”€â”€ docs/                         # ğŸ“š é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture.md           # æ¶æ„æ–‡æ¡£ (æœ¬æ–‡ä»¶)
â”‚   â”œâ”€â”€ project-progress.md       # é¡¹ç›®è¿›åº¦è¡¨
â”‚   â”œâ”€â”€ visual-guidelines.md      # è§†è§‰è§„èŒƒæ–‡æ¡£
â”‚   â”œâ”€â”€ page-map.json             # é¡µé¢ç»“æ„æ˜ å°„
â”‚   â””â”€â”€ entity-relations.json     # å®ä½“å…³ç³»æ˜ å°„
â”‚
â”œâ”€â”€ src/                          # ğŸ¨ SvelteKit æºç 
â”‚   â”œâ”€â”€ routes/                   # é¡µé¢è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ +page.svelte          # é¦–é¡µ
â”‚   â”‚   â”œâ”€â”€ +layout.svelte        # å…¨å±€å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ about/
â”‚   â”‚   â”‚   â””â”€â”€ +page.svelte
â”‚   â”‚   â”œâ”€â”€ practices/
â”‚   â”‚   â”‚   â”œâ”€â”€ +page.svelte      # ä¸šåŠ¡é¢†åŸŸåˆ—è¡¨
â”‚   â”‚   â”‚   â””â”€â”€ [slug]/
â”‚   â”‚   â”‚       â””â”€â”€ +page.svelte  # ä¸šåŠ¡é¢†åŸŸè¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ team/
â”‚   â”‚   â”‚   â”œâ”€â”€ +page.svelte      # å¾‹å¸ˆåˆ—è¡¨
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â””â”€â”€ +page.svelte  # å¾‹å¸ˆè¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ news/
â”‚   â”‚   â”‚   â”œâ”€â”€ +page.svelte      # æ–°é—»åˆ—è¡¨
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â””â”€â”€ +page.svelte  # æ–°é—»è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ events/
â”‚   â”‚   â”‚   â”œâ”€â”€ +page.svelte      # æ´»åŠ¨åˆ—è¡¨
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â””â”€â”€ +page.svelte  # æ´»åŠ¨è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ careers/
â”‚   â”‚   â”‚   â””â”€â”€ +page.svelte      # æ‹›è˜é¡µé¢
â”‚   â”‚   â”œâ”€â”€ contact/
â”‚   â”‚   â”‚   â””â”€â”€ +page.svelte      # è”ç³»æˆ‘ä»¬
â”‚   â”‚   â””â”€â”€ search/
â”‚   â”‚       â””â”€â”€ +page.svelte      # æœç´¢ç»“æœ
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ components/           # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Seo.svelte        # SEO Meta ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ LanguageSwitcher.svelte
â”‚   â”‚   â”‚   â””â”€â”€ Breadcrumb.svelte
â”‚   â”‚   â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ i18n.ts           # å¤šè¯­è¨€å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ format.ts         # æ ¼å¼åŒ–å·¥å…·
â”‚   â”‚   â”‚   â””â”€â”€ seo.ts            # SEO å·¥å…·
â”‚   â”‚   â””â”€â”€ types/                # TypeScript ç±»å‹
â”‚   â”‚       â”œâ”€â”€ lawyer.ts
â”‚   â”‚       â”œâ”€â”€ news.ts
â”‚   â”‚       â”œâ”€â”€ practice.ts
â”‚   â”‚       â””â”€â”€ event.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ app.html                  # HTML æ¨¡æ¿
â”‚   â””â”€â”€ app.css                   # å…¨å±€æ ·å¼å…¥å£
â”‚
â”œâ”€â”€ ui-kit/                       # ğŸ§© UI ç»„ä»¶åº“
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ base/                 # åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Typography.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ Card.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ Input.svelte
â”‚   â”‚   â”‚   â””â”€â”€ Link.svelte
â”‚   â”‚   â”œâ”€â”€ layout/               # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Hero.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ Footer.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ Navigation.svelte
â”‚   â”‚   â”‚   â””â”€â”€ Section.svelte
â”‚   â”‚   â””â”€â”€ domain/               # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ LawyerCard.svelte
â”‚   â”‚       â”œâ”€â”€ NewsCard.svelte
â”‚   â”‚       â”œâ”€â”€ PracticeCard.svelte
â”‚   â”‚       â””â”€â”€ ContactForm.svelte
â”‚   â”‚
â”‚   â””â”€â”€ styles/                   # æ ·å¼ä½“ç³»
â”‚       â”œâ”€â”€ variables.scss        # SCSS å˜é‡
â”‚       â”œâ”€â”€ mixins.scss           # SCSS æ··å…¥
â”‚       â”œâ”€â”€ global.scss           # å…¨å±€æ ·å¼
â”‚       â””â”€â”€ reset.scss            # CSS Reset
â”‚
â”œâ”€â”€ adapter/                      # ğŸ”Œ åå°é€‚é…å±‚
â”‚   â”œâ”€â”€ schema-map.json           # å­—æ®µæ˜ å°„è¡¨
â”‚   â”œâ”€â”€ api-client.ts             # API å®¢æˆ·ç«¯å°è£…
â”‚   â”œâ”€â”€ types.ts                  # åå°æ•°æ®ç±»å‹
â”‚   â””â”€â”€ mock-data/                # æ¨¡æ‹Ÿæ•°æ® (å¼€å‘é˜¶æ®µ)
â”‚       â”œâ”€â”€ lawyers.json
â”‚       â”œâ”€â”€ news.json
â”‚       â”œâ”€â”€ practices.json
â”‚       â””â”€â”€ events.json
â”‚
â”œâ”€â”€ hooks/                        # ğŸ”§ å¢å€¼åŠŸèƒ½æ¥å£ (é¢„ç•™)
â”‚   â”œâ”€â”€ mirror.ts                 # å›½é™…é•œåƒéƒ¨ç½²
â”‚   â”œâ”€â”€ seo-report.ts             # SEO æŠ¥å‘Šç”Ÿæˆ
â”‚   â””â”€â”€ monitor.ts                # æ€§èƒ½ç›‘æ§
â”‚
â”œâ”€â”€ locales/                      # ğŸŒ å¤šè¯­è¨€é…ç½®
â”‚   â”œâ”€â”€ zh.json                   # ç®€ä½“ä¸­æ–‡
â”‚   â””â”€â”€ en.json                   # English
â”‚
â”œâ”€â”€ qa/                           # âœ… è´¨é‡ä¿éšœ
â”‚   â”œâ”€â”€ scripts/                  # æµ‹è¯•è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ lighthouse.js         # Lighthouse æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ a11y-check.js         # A11y æ£€æµ‹
â”‚   â”‚   â””â”€â”€ seo-check.js          # SEO éªŒè¯
â”‚   â””â”€â”€ reports/                  # æµ‹è¯•æŠ¥å‘Šè¾“å‡º
â”‚       â”œâ”€â”€ lighthouse-summary.json
â”‚       â”œâ”€â”€ a11y-report.json
â”‚       â”œâ”€â”€ seo-report.json
â”‚       â””â”€â”€ final-qa-report.md
â”‚
â””â”€â”€ static/                       # ğŸ“¦ é™æ€èµ„æº
    â”œâ”€â”€ images/                   # å›¾ç‰‡èµ„æº
    â”‚   â”œâ”€â”€ logo.svg
    â”‚   â”œâ”€â”€ hero-banner.jpg
    â”‚   â””â”€â”€ lawyers/              # å¾‹å¸ˆç…§ç‰‡
    â”œâ”€â”€ fonts/                    # å­—ä½“æ–‡ä»¶
    â””â”€â”€ favicon.ico
```

---

## 3. æ¨¡å—èŒè´£

### 3.1 src/routes (é¡µé¢è·¯ç”±)
**èŒè´£**: å®šä¹‰æ‰€æœ‰é¡µé¢æ¨¡æ¿ä¸è·¯ç”±é€»è¾‘

**è§„èŒƒ**:
- ä½¿ç”¨ SvelteKit æ–‡ä»¶è·¯ç”±è§„èŒƒ
- åŠ¨æ€è·¯ç”±ä½¿ç”¨ `[param]` å‘½å
- æ¯ä¸ªé¡µé¢å¿…é¡»åŒ…å« SEO Meta ä¿¡æ¯
- æ•°æ®åŠ è½½ä½¿ç”¨ `+page.ts` æˆ– `+page.server.ts`

**ç¤ºä¾‹**:
```svelte
<!-- src/routes/team/[id]/+page.svelte -->
<script lang="ts">
  import { LawyerCard } from '$ui-kit/components/domain';
  export let data;
</script>

<LawyerCard lawyer={data.lawyer} />
```

---

### 3.2 ui-kit (UI ç»„ä»¶åº“)
**èŒè´£**: æä¾›å¯å¤ç”¨çš„ UI ç»„ä»¶ä¸æ ·å¼ä½“ç³»

**è§„èŒƒ**:
- æ‰€æœ‰ç»„ä»¶ä½¿ç”¨ **PascalCase** å‘½å
- æ‰€æœ‰æ ·å¼ä½¿ç”¨ **SCSS å˜é‡ä½“ç³»**
- ç»„ä»¶å¿…é¡»åŒ…å« **props ç±»å‹å®šä¹‰**
- ç¦æ­¢ä½¿ç”¨å†…è”æ ·å¼æˆ– Tailwind

**ç¤ºä¾‹**:
```svelte
<!-- ui-kit/components/base/Button.svelte -->
<script lang="ts">
  export let variant: 'primary' | 'secondary' = 'primary';
  export let size: 'sm' | 'md' | 'lg' = 'md';
</script>

<button class="btn btn--{variant} btn--{size}">
  <slot />
</button>

<style lang="scss">
@import '$ui-kit/styles/variables.scss';

.btn {
  padding: $spacing-sm $spacing-md;
  background: $color-primary;
  color: white;

  &--secondary {
    background: $color-secondary;
  }
}
</style>
```

---

### 3.3 adapter (åå°é€‚é…å±‚)
**èŒè´£**: å°è£…åå° API è°ƒç”¨ï¼Œå¤„ç†å­—æ®µæ˜ å°„

**æ ¸å¿ƒæ–‡ä»¶**:
- `schema-map.json`: å®šä¹‰åå°å­—æ®µåˆ°å‰ç«¯å­—æ®µçš„æ˜ å°„å…³ç³»
- `api-client.ts`: å°è£…æ‰€æœ‰ API è¯·æ±‚
- `types.ts`: å®šä¹‰åå°æ•°æ®ç±»å‹

**ç¤ºä¾‹**:
```typescript
// adapter/api-client.ts
import type { Lawyer, Practice } from './types';
import schemaMap from './schema-map.json';

export async function fetchLawyers(): Promise<Lawyer[]> {
  const response = await fetch('/api/lawyers');
  const rawData = await response.json();

  // ä½¿ç”¨ schema-map è½¬æ¢å­—æ®µ
  return rawData.map(item => transformFields(item, schemaMap.lawyer));
}
```

---

### 3.4 locales (å¤šè¯­è¨€)
**èŒè´£**: ç®¡ç†ä¸­è‹±æ–‡è¯­è¨€åŒ…

**è§„èŒƒ**:
- ä½¿ç”¨ JSON æ ¼å¼å­˜å‚¨ç¿»è¯‘
- é”®åä½¿ç”¨ç‚¹åˆ†å‘½å (eg. `nav.home`)
- ä¸­è‹±æ–‡å¿…é¡»ä¿æŒç»“æ„ä¸€è‡´

**ç¤ºä¾‹**:
```json
// locales/zh.json
{
  "nav": {
    "home": "é¦–é¡µ",
    "about": "å…³äºæˆ‘ä»¬",
    "practices": "ä¸šåŠ¡é¢†åŸŸ"
  }
}

// locales/en.json
{
  "nav": {
    "home": "Home",
    "about": "About Us",
    "practices": "Practice Areas"
  }
}
```

---

### 3.5 qa (è´¨é‡ä¿éšœ)
**èŒè´£**: æ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ä¸ç”ŸæˆæŠ¥å‘Š

**æµ‹è¯•ç±»å‹**:
1. **Lighthouse**: æ€§èƒ½ / SEO / A11y / Best Practices
2. **A11y**: ARIA æ ‡ç­¾ / è‰²å½©å¯¹æ¯”åº¦ / é”®ç›˜å¯¼èˆª
3. **SEO**: Meta æ ‡ç­¾ / Sitemap / Structured Data

**æ‰§è¡Œæ–¹å¼**:
```bash
npm run test:lighthouse  # è¿è¡Œ Lighthouse æµ‹è¯•
npm run test:a11y        # è¿è¡Œ A11y æ£€æµ‹
npm run test:seo         # è¿è¡Œ SEO éªŒè¯
npm run test:all         # è¿è¡Œæ‰€æœ‰æµ‹è¯•
```

---

## 4. æ•°æ®æµ

### 4.1 é™æ€æ•°æ®æµ (SSG)
```
åå° API â†’ Mock Data â†’ SvelteKit Build â†’ Static HTML
```
**é€‚ç”¨é¡µé¢**: å…³äºæˆ‘ä»¬ã€ä¸šåŠ¡é¢†åŸŸåˆ—è¡¨

---

### 4.2 åŠ¨æ€æ•°æ®æµ (SSR)
```
ç”¨æˆ·è¯·æ±‚ â†’ SvelteKit Server â†’ Adapter Layer â†’ åå° API â†’ è¿”å› HTML
```
**é€‚ç”¨é¡µé¢**: å¾‹å¸ˆè¯¦æƒ…ã€æ–°é—»è¯¦æƒ…

---

### 4.3 å®¢æˆ·ç«¯æ•°æ®æµ (CSR)
```
ç”¨æˆ·æ“ä½œ â†’ å‰ç«¯ JS â†’ Adapter Layer â†’ åå° API â†’ æ›´æ–° DOM
```
**é€‚ç”¨åŠŸèƒ½**: æœç´¢ã€è¡¨å•æäº¤

---

## 5. æ¸²æŸ“ç­–ç•¥

| é¡µé¢ç±»å‹ | æ¸²æŸ“æ–¹å¼ | ç†ç”± |
|---------|---------|------|
| é¦–é¡µ | SSG | å†…å®¹å›ºå®šï¼ŒSEO å‹å¥½ |
| å…³äºæˆ‘ä»¬ | SSG | å†…å®¹å›ºå®šï¼ŒSEO å‹å¥½ |
| ä¸šåŠ¡é¢†åŸŸåˆ—è¡¨ | SSG | åˆ†ç±»å›ºå®šï¼ŒSEO å‹å¥½ |
| ä¸šåŠ¡é¢†åŸŸè¯¦æƒ… | SSG | æ•°æ®ç¨³å®šï¼ŒSEO å‹å¥½ |
| å¾‹å¸ˆåˆ—è¡¨ | SSR | éœ€è¦ç­›é€‰åŠŸèƒ½ |
| å¾‹å¸ˆè¯¦æƒ… | SSR | å†…å®¹åŠ¨æ€æ›´æ–° |
| æ–°é—»åˆ—è¡¨ | SSR | å†…å®¹é¢‘ç¹æ›´æ–° |
| æ–°é—»è¯¦æƒ… | SSR | å†…å®¹åŠ¨æ€æ›´æ–° |
| æœç´¢ç»“æœ | CSR | ç”¨æˆ·äº¤äº’é©±åŠ¨ |
| è”ç³»è¡¨å• | CSR | è¡¨å•æäº¤ |

---

## 6. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 6.1 å›¾ç‰‡ä¼˜åŒ–
- ä½¿ç”¨ WebP æ ¼å¼ (é™çº§ JPG/PNG)
- å®ç°æ‡’åŠ è½½ (Intersection Observer)
- ä½¿ç”¨å“åº”å¼å›¾ç‰‡ (`srcset`)

### 6.2 ä»£ç åˆ†å‰²
- æŒ‰è·¯ç”±è‡ªåŠ¨åˆ†å‰² (SvelteKit é»˜è®¤)
- åŠ¨æ€ import å¤§å‹ç»„ä»¶
- æå–å…¬å…±ä¾èµ– (Vite)

### 6.3 CSS ä¼˜åŒ–
- ä½¿ç”¨ SCSS æ¨¡å—åŒ–
- ç§»é™¤æœªä½¿ç”¨çš„æ ·å¼ (PurgeCSS)
- å‹ç¼© CSS (cssnano)

### 6.4 ç¼“å­˜ç­–ç•¥
- é™æ€èµ„æºä½¿ç”¨å¼ºç¼“å­˜ (1 å¹´)
- API å“åº”ä½¿ç”¨åå•†ç¼“å­˜ (ETag)
- Service Worker ç¦»çº¿ç¼“å­˜ (å¯é€‰)

---

## 7. SEO ä¼˜åŒ–ç­–ç•¥

### 7.1 Meta æ ‡ç­¾
æ¯ä¸ªé¡µé¢å¿…é¡»åŒ…å«ï¼š
- `<title>` (å”¯ä¸€)
- `<meta name="description">`
- `<meta property="og:*">` (Open Graph)
- `<link rel="canonical">`

### 7.2 å¤šè¯­è¨€ SEO
- ä½¿ç”¨ `<link rel="alternate" hreflang="zh-CN">`
- URL ç»“æ„: `/zh/...` ä¸ `/en/...`
- ç”Ÿæˆå¤šè¯­è¨€ Sitemap

### 7.3 ç»“æ„åŒ–æ•°æ®
ä½¿ç”¨ JSON-LD æ ¼å¼ï¼š
- `Organization` (å¾‹æ‰€ä¿¡æ¯)
- `Person` (å¾‹å¸ˆä¿¡æ¯)
- `Article` (æ–°é—»æ–‡ç« )

---

## 8. å®‰å…¨è§„èŒƒ

### 8.1 è¾“å…¥éªŒè¯
- æ‰€æœ‰è¡¨å•è¾“å…¥å¿…é¡»å‰åç«¯åŒé‡éªŒè¯
- é˜²æ­¢ XSS æ”»å‡» (Svelte è‡ªåŠ¨è½¬ä¹‰)
- é˜²æ­¢ CSRF æ”»å‡» (SvelteKit CSRF Token)

### 8.2 æ•°æ®ä¼ è¾“
- å…¨ç«™ HTTPS
- API è¯·æ±‚ä½¿ç”¨ CORS ç™½åå•
- æ•æ„Ÿæ•°æ®åŠ å¯†ä¼ è¾“

---

## 9. æµè§ˆå™¨å…¼å®¹æ€§

### 9.1 ç›®æ ‡æµè§ˆå™¨
- Chrome (æœ€æ–°ç‰ˆæœ¬ + 1 ä¸ªæ—§ç‰ˆæœ¬)
- Firefox (æœ€æ–°ç‰ˆæœ¬ + 1 ä¸ªæ—§ç‰ˆæœ¬)
- Safari (æœ€æ–°ç‰ˆæœ¬ + 1 ä¸ªæ—§ç‰ˆæœ¬)
- Edge (æœ€æ–°ç‰ˆæœ¬)
- ç§»åŠ¨ç«¯: iOS Safari 14+, Chrome Android 100+

### 9.2 é™çº§ç­–ç•¥
- ä½¿ç”¨ PostCSS è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€
- ä½¿ç”¨ `@vitejs/plugin-legacy` æ”¯æŒæ—§æµè§ˆå™¨
- æä¾› JavaScript ä¸å¯ç”¨æ—¶çš„åŸºç¡€å†…å®¹

---

## 10. éƒ¨ç½²æ¶æ„

### 10.1 æ¨èéƒ¨ç½²æ–¹å¼
```
ç”¨æˆ· â†’ CDN (é™æ€èµ„æº) â†’ Vercel/Netlify (SvelteKit SSR) â†’ åå° API
```

### 10.2 å›½é™…é•œåƒéƒ¨ç½² (å¢å€¼æœåŠ¡)
```
å›½å†…ç”¨æˆ· â†’ é˜¿é‡Œäº‘ CDN â†’ å›½å†…æœåŠ¡å™¨
æµ·å¤–ç”¨æˆ· â†’ Cloudflare CDN â†’ AWS/Vercel
```

---

## 11. ç›‘æ§ä¸ç»´æŠ¤

### 11.1 æ€§èƒ½ç›‘æ§
- Lighthouse CI (å®šæœŸè‡ªåŠ¨æµ‹è¯•)
- Real User Monitoring (çœŸå®ç”¨æˆ·æ•°æ®)
- Error Tracking (Sentry)

### 11.2 æ—¥å¿—ç®¡ç†
- å‰ç«¯é”™è¯¯æ—¥å¿— (console.error â†’ æœåŠ¡ç«¯)
- API è¯·æ±‚æ—¥å¿—
- ç”¨æˆ·è¡Œä¸ºåˆ†æ (å¯é€‰)

---

## 12. Schema-Driven Architectureï¼ˆæ¨¡å¼é©±åŠ¨æ¶æ„ï¼‰

### 12.1 æ ¸å¿ƒç†å¿µ

åè¯šå¾‹å¸ˆäº‹åŠ¡æ‰€é—¨æˆ·ç½‘ç«™é‡‡ç”¨ **Schema-Driven Architecture**ï¼Œè¿™æ˜¯ä¸€ç§å°†å†…å®¹ç»“æ„ä¸å±•ç¤ºé€»è¾‘è§£è€¦çš„æ¶æ„æ¨¡å¼ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯ï¼š

> **æ‰€æœ‰åŠ¨æ€å†…å®¹ç”± JSON Schema å®šä¹‰ï¼Œå‰ç«¯åªè´Ÿè´£æ¸²æŸ“ï¼Œå†…å®¹ç®¡ç†äº¤ç»™åå° CMS**

**æ¶æ„ä¼˜åŠ¿**:
1. **å†…å®¹ä¸ä»£ç åˆ†ç¦»**: å†…å®¹æ›´æ–°æ— éœ€ä¿®æ”¹ä»£ç æˆ–é‡æ–°éƒ¨ç½²
2. **å¤©ç„¶å¤šè¯­è¨€æ”¯æŒ**: Schema å­—æ®µåŒ…å« `_zh`/`_en` åç¼€ï¼Œåˆ‡æ¢è¯­è¨€å³åˆ‡æ¢å­—æ®µ
3. **å¯Œæ–‡æœ¬æ ‡å‡†åŒ–**: åå°ç¼–è¾‘å™¨è¾“å‡º HTML â†’ Adapter è½¬æ¢ â†’ å‰ç«¯ç»Ÿä¸€æ ·å¼æ¸²æŸ“
4. **CRUD å‹å¥½**: å¢åˆ æ”¹æŸ¥ç›´æ¥æ“ä½œ Schema å¯¹è±¡æ•°ç»„

---

### 12.2 æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åå° CMS                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆWYSIWYGï¼‰                      â”‚  â”‚
â”‚  â”‚  - è¾“å…¥ä¸­è‹±æ–‡åç§°ã€æè¿°                               â”‚  â”‚
â”‚  â”‚  - ç¼–è¾‘å¯Œæ–‡æœ¬å†…å®¹ï¼ˆæ’å…¥å›¾ç‰‡ã€åˆ—è¡¨ã€è¡¨æ ¼ï¼‰             â”‚  â”‚
â”‚  â”‚  - è¾“å‡º: HTML å­—ç¬¦ä¸²                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ JSON Response
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Adapter Layer                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  schema-map.json: åå°å­—æ®µ â†’ å‰ç«¯å­—æ®µæ˜ å°„            â”‚  â”‚
â”‚  â”‚  - name.zh â†’ name_zh                                 â”‚  â”‚
â”‚  â”‚  - rich_content â†’ richContent                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  api-client.ts: API è°ƒç”¨ + å­—æ®µè½¬æ¢                  â”‚  â”‚
â”‚  â”‚  - fetchPractices(): PracticeSchema[]                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ PracticeSchema[]
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Frontend (SvelteKit)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Picker ç»„ä»¶: Schema å®¹å™¨                             â”‚  â”‚
â”‚  â”‚  - tabs = schemas.map(s => ({ label: s.name_zh }))  â”‚  â”‚
â”‚  â”‚  - åŠ¨æ€ç”Ÿæˆ Tab åˆ—è¡¨                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Rich Content æ¸²æŸ“                                    â”‚  â”‚
â”‚  â”‚  - <div class="rich-content">{@html schema.richContent}</div> â”‚
â”‚  â”‚  - ç»Ÿä¸€æ ·å¼: .rich-content { ... }                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 12.3 Schema å®šä¹‰è§„èŒƒ

#### åŸºç¡€ Schema ç»“æ„

æ‰€æœ‰ Schema å¿…é¡»ç»§æ‰¿ `BaseSchema`:

```typescript
interface BaseSchema {
  id: string;           // å”¯ä¸€æ ‡è¯†ï¼ˆUUID æˆ–è‡ªå¢ IDï¼‰
  slug: string;         // URL å‹å¥½æ ‡è¯†ï¼ˆç”¨äº SEOï¼‰
  createdAt: string;    // åˆ›å»ºæ—¶é—´ï¼ˆISO 8601ï¼‰
  updatedAt: string;    // æ›´æ–°æ—¶é—´ï¼ˆISO 8601ï¼‰
}
```

#### ä¸šåŠ¡é¢†åŸŸ Schema ç¤ºä¾‹

```typescript
// adapter/schema/practice.ts
interface PracticeSchema extends BaseSchema {
  // åˆ†ç±»
  category: 'æ ¸å¿ƒä¸šåŠ¡' | 'è¡Œä¸šä¸“é•¿' | 'ä¸“ä¸šæœåŠ¡';

  // å¤šè¯­è¨€å­—æ®µï¼ˆå¿…å¡«ï¼‰
  name_zh: string;             // ä¸­æ–‡åç§°
  name_en: string;             // è‹±æ–‡åç§°
  description_zh: string;      // ä¸­æ–‡ç®€ä»‹ï¼ˆâ‰¤200å­—ï¼‰
  description_en: string;      // è‹±æ–‡ç®€ä»‹ï¼ˆâ‰¤200å­—ï¼‰

  // ç»“æ„åŒ–æ•°æ®
  services: string[];          // æ ¸å¿ƒæœåŠ¡åˆ—è¡¨
  cases?: string;              // æ¡ˆä¾‹æˆæœï¼ˆå¯é€‰ï¼‰

  // å¯Œæ–‡æœ¬å†…å®¹ï¼ˆå¯é€‰ï¼‰
  richContent?: string;        // åå°ç¼–è¾‘å™¨è¾“å‡ºçš„ HTML
}
```

**å­—æ®µè®¾è®¡åŸåˆ™**:
1. **å¤šè¯­è¨€å­—æ®µä½¿ç”¨åç¼€**: `_zh`/`_en`ï¼Œä¸ä½¿ç”¨åµŒå¥—å¯¹è±¡
2. **å¯Œæ–‡æœ¬å­—æ®µå‘½å**: `richContent` (camelCase)
3. **å¯é€‰å­—æ®µä½¿ç”¨ `?`**: æ˜ç¡®åŒºåˆ†å¿…å¡«å’Œå¯é€‰

---

### 12.4 Picker ç»„ä»¶ä½œä¸º Schema å®¹å™¨

**ä¸ºä»€ä¹ˆä½¿ç”¨ Pickerï¼Ÿ**

Picker ç»„ä»¶æ˜¯ Schema-Driven Architecture çš„æ ¸å¿ƒäº¤äº’ç»„ä»¶ï¼Œå®ƒçš„ä¼˜åŠ¿ï¼š

1. **æ¨¡å—åŒ–**: æ¯ä¸ª Tab å¯¹åº”ä¸€ä¸ª Schema å¯¹è±¡
2. **CRUD å‹å¥½**: å¢åˆ æ”¹æŸ¥ = æ“ä½œ Schema æ•°ç»„
3. **å¤šè¯­è¨€åŸç”Ÿæ”¯æŒ**: Tab æ ‡ç­¾ä» `schema.name_zh` æˆ– `schema.name_en` åŠ¨æ€ç”Ÿæˆ
4. **çµæ´»è°ƒåº¦**: æ’åºã€è¿‡æ»¤ã€æ˜¾ç¤º/éšè— Tab é€šè¿‡æ•°ç»„æ“ä½œå®ç°

**ä»£ç ç¤ºä¾‹**:

```typescript
// src/routes/(app)/practices/+page.svelte
const practices: PracticeSchema[] = [
  {
    id: 'ip',
    slug: 'intellectual-property',
    category: 'æ ¸å¿ƒä¸šåŠ¡',
    name_zh: 'çŸ¥è¯†äº§æƒ',
    name_en: 'Intellectual Property',
    description_zh: 'ä¸“æ³¨äºä¸“åˆ©ã€å•†æ ‡ã€è‘—ä½œæƒç­‰çŸ¥è¯†äº§æƒé¢†åŸŸ...',
    description_en: 'Focus on IP protection...',
    services: ['ä¸“åˆ©ç”³è¯·', 'å•†æ ‡æ³¨å†Œ', 'è‘—ä½œæƒç™»è®°'],
    richContent: `<h3>çŸ¥è¯†äº§æƒæ³•å¾‹æœåŠ¡</h3><p>...</p>`
  },
  // ... æ›´å¤šä¸šåŠ¡é¢†åŸŸ
];

// åŠ¨æ€ç”Ÿæˆ Tabs
const tabs = [
  { id: 'intro', label: 'ç®€ä»‹', type: 'intro' },
  ...practices.map(p => ({
    id: p.id,
    label: p.name_zh,  // å¤šè¯­è¨€åˆ‡æ¢æ—¶æ”¹ä¸º p.name_en
    type: 'practice',
    data: p
  }))
];
```

**CRUD æ“ä½œç¤ºä¾‹**:

```typescript
// æ–°å¢ä¸šåŠ¡é¢†åŸŸ
practices = [...practices, newPractice];

// åˆ é™¤ä¸šåŠ¡é¢†åŸŸ
practices = practices.filter(p => p.id !== targetId);

// æ›´æ–°ä¸šåŠ¡é¢†åŸŸ
practices = practices.map(p =>
  p.id === targetId ? { ...p, name_zh: 'æ–°åç§°' } : p
);

// æ’åºä¸šåŠ¡é¢†åŸŸ
practices = practices.sort((a, b) => a.name_zh.localeCompare(b.name_zh));
```

---

### 12.5 å¯Œæ–‡æœ¬å†…å®¹æ¸²æŸ“

#### æ¸²æŸ“æ–¹å¼

ä½¿ç”¨ Svelte çš„ `{@html}` æŒ‡ä»¤æ¸²æŸ“åå°ç¼–è¾‘å™¨è¾“å‡ºçš„ HTML:

```svelte
<div class="rich-content">
  {@html practice.richContent}
</div>
```

#### ç»Ÿä¸€æ ·å¼ç³»ç»Ÿ

`.rich-content` æ ·å¼ç±»æä¾›ç»Ÿä¸€çš„å¯Œæ–‡æœ¬æ¸²æŸ“æ ·å¼:

| å…ƒç´  | æ ·å¼ç‰¹ç‚¹ |
|------|----------|
| **æ ‡é¢˜** | `<h3>` ä¸»æ ‡é¢˜ã€`<h4>` å­æ ‡é¢˜ã€`<h5>` ç»†èŠ‚æ ‡é¢˜ |
| **æ®µè½** | `<p>` è¡Œé«˜ 1.8ã€é—´è· 1.5rem |
| **åˆ—è¡¨** | `<ul>` è‡ªå®šä¹‰åœ†ç‚¹ï¼ˆä¸»é¢˜è‰²ï¼‰ã€`<ol>` æ•°å­—ç¼–å· |
| **å›¾ç‰‡** | é»˜è®¤å±…ä¸­ã€æ”¯æŒ `.align-left`/`.align-right`/`.align-center` |
| **è¡¨æ ¼** | æ–‘é©¬çº¹ã€æ‚¬åœé«˜äº® |
| **å¼•ç”¨** | å·¦ä¾§é‡‘è‰²è¾¹æ¡†ã€æµ…è‰²èƒŒæ™¯ |
| **ä»£ç ** | è¡Œå†…ä»£ç æµ…ç°èƒŒæ™¯ã€ä»£ç å—æ·±è‰²ä¸»é¢˜ |

**æ ·å¼ç¤ºä¾‹**:

```scss
.rich-content {
  :global(h3) {
    font-size: 1.75rem;
    color: $color-primary;
    margin-bottom: 1.5rem;
  }

  :global(img) {
    max-width: 100%;
    height: auto;
    margin: 2rem auto;
    display: block;
    border-radius: 0.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  :global(img.align-left) {
    float: left;
    margin: 0.5rem 2rem 1rem 0;
    max-width: 50%;
  }
}
```

#### XSS é˜²æŠ¤

**ç”Ÿäº§ç¯å¢ƒå¿…é¡»å‡€åŒ– HTML**:

```typescript
import DOMPurify from 'dompurify';

const safeHTML = DOMPurify.sanitize(practice.richContent, {
  ALLOWED_TAGS: ['h3', 'h4', 'h5', 'p', 'ul', 'ol', 'li', 'strong', 'em', 'a', 'img', 'table', 'thead', 'tbody', 'tr', 'th', 'td', 'blockquote', 'code', 'pre'],
  ALLOWED_ATTR: ['href', 'src', 'alt', 'class', 'target']
});
```

---

### 12.6 Adapter å±‚è®¾è®¡

#### `schema-map.json` - å­—æ®µæ˜ å°„è¡¨

å®šä¹‰åå°å­—æ®µåˆ°å‰ç«¯ Schema å­—æ®µçš„æ˜ å°„å…³ç³»:

```json
{
  "practice": {
    "id": "id",
    "slug": "slug",
    "category": "category",
    "name.zh": "name_zh",
    "name.en": "name_en",
    "description.zh": "description_zh",
    "description.en": "description_en",
    "services": "services",
    "cases": "cases",
    "rich_content": "richContent",
    "created_at": "createdAt",
    "updated_at": "updatedAt"
  }
}
```

**æ˜ å°„è§„åˆ™**:
- æ”¯æŒåµŒå¥—è·¯å¾„ï¼ˆç‚¹åˆ†ï¼‰: `name.zh` â†’ `name_zh`
- æ”¯æŒä¸‹åˆ’çº¿è½¬é©¼å³°: `rich_content` â†’ `richContent`
- æ”¯æŒæ•°ç»„å­—æ®µ: ç›´æ¥æ˜ å°„

#### `api-client.ts` - API å®¢æˆ·ç«¯

å°è£…æ‰€æœ‰ API è°ƒç”¨ï¼Œç»Ÿä¸€è¿›è¡Œå­—æ®µè½¬æ¢:

```typescript
import schemaMap from './schema-map.json';
import { transformFields } from './utils';

export async function fetchPractices(): Promise<PracticeSchema[]> {
  try {
    const response = await fetch('/api/v1/practices');
    const rawData = await response.json();

    // ä½¿ç”¨ schema-map è½¬æ¢å­—æ®µ
    return rawData.map(item => transformFields(item, schemaMap.practice));
  } catch (error) {
    console.error('Failed to fetch practices:', error);
    return [];  // è¿”å›ç©ºæ•°ç»„ï¼Œä¸ä¸­æ–­é¡µé¢æ¸²æŸ“
  }
}
```

**é”™è¯¯å¤„ç†ç­–ç•¥**:
- ç½‘ç»œé”™è¯¯: è¿”å›ç©ºæ•°ç»„ `[]`
- å­—æ®µç¼ºå¤±: ä½¿ç”¨é»˜è®¤å€¼ï¼ˆç©ºå­—ç¬¦ä¸²ã€ç©ºæ•°ç»„ï¼‰
- ç±»å‹é”™è¯¯: è®°å½•æ—¥å¿—å¹¶è·³è¿‡è¯¥æ¡æ•°æ®

---

### 12.7 å¤šè¯­è¨€æ¶æ„

#### URL ç»“æ„

ä½¿ç”¨è·¯å¾„å‰ç¼€åŒºåˆ†è¯­è¨€:

```
/zh/practices  â†’ ä¸­æ–‡ä¸šåŠ¡é¢†åŸŸé¡µ
/en/practices  â†’ è‹±æ–‡ä¸šåŠ¡é¢†åŸŸé¡µ
```

#### è¯­è¨€åˆ‡æ¢é€»è¾‘

æ ¹æ®å½“å‰è¯­è¨€åˆ‡æ¢ Schema å­—æ®µ:

```typescript
// $state
let currentLang = $state<'zh' | 'en'>('zh');

// $derived
const displayName = $derived(
  currentLang === 'zh' ? practice.name_zh : practice.name_en
);

const displayDescription = $derived(
  currentLang === 'zh' ? practice.description_zh : practice.description_en
);

// Tab æ ‡ç­¾åŠ¨æ€ç”Ÿæˆ
const tabs = practices.map(p => ({
  id: p.id,
  label: currentLang === 'zh' ? p.name_zh : p.name_en,
  data: p
}));
```

#### SEO å¤šè¯­è¨€æ”¯æŒ

æ¯ä¸ªé¡µé¢å¿…é¡»åŒ…å« `hreflang` æ ‡ç­¾:

```svelte
<svelte:head>
  <link rel="alternate" hreflang="zh-CN" href="https://example.com/zh/practices" />
  <link rel="alternate" hreflang="en-US" href="https://example.com/en/practices" />
  <link rel="alternate" hreflang="x-default" href="https://example.com/zh/practices" />
</svelte:head>
```

---

### 12.8 å®æ–½ç¤ºä¾‹ï¼šä¸šåŠ¡é¢†åŸŸé¡µé¢

**æ–‡ä»¶ç»“æ„**:
```
src/routes/(app)/practices/
â”œâ”€â”€ +page.svelte         # é¡µé¢ç»„ä»¶
â”œâ”€â”€ +page.ts             # æ•°æ®åŠ è½½
â””â”€â”€ schema.ts            # Schema å®šä¹‰ï¼ˆä»…ä¾›å‚è€ƒï¼‰
```

**æ•°æ®æµ**:

```typescript
// +page.ts
import { fetchPractices } from '$lib/adapter/api-client';

export async function load() {
  const practices = await fetchPractices();
  return { practices };
}
```

```svelte
<!-- +page.svelte -->
<script lang="ts">
  import { Picker } from '$ui/components';

  let { data } = $props();
  let practices = $state(data.practices);
  let activeTabIndex = $state(0);

  const tabs = [
    { id: 'intro', label: 'ç®€ä»‹', type: 'intro' },
    ...practices.map(p => ({
      id: p.id,
      label: p.name_zh,
      type: 'practice',
      data: p
    }))
  ];
</script>

<!-- Picker ç»„ä»¶ -->
<Picker
  items={tabs}
  activeIndex={activeTabIndex}
  orientation="horizontal"
  onSelect={(index) => activeTabIndex = index}
/>

<!-- å†…å®¹æ¸²æŸ“ -->
<div class="content">
  {#if activeTabIndex === 0}
    <!-- ç®€ä»‹å†…å®¹ -->
  {:else}
    {@const practice = practices[activeTabIndex - 1]}
    <div class="rich-content">
      {@html practice.richContent}
    </div>
  {/if}
</div>
```

---

### 12.9 æ‰©å±•åœºæ™¯

#### æ–°å¢å†…å®¹ç±»å‹

æ·»åŠ æ–°çš„å†…å®¹ç±»å‹ï¼ˆå¦‚æ¡ˆä¾‹ç ”ç©¶ï¼‰åªéœ€ä¸‰æ­¥:

1. **å®šä¹‰ Schema**:
```typescript
// adapter/schema/case-study.ts
interface CaseStudySchema extends BaseSchema {
  title_zh: string;
  title_en: string;
  summary_zh: string;
  summary_en: string;
  richContent?: string;
}
```

2. **æ·»åŠ  Adapter**:
```typescript
// adapter/api-client.ts
export async function fetchCaseStudies(): Promise<CaseStudySchema[]> {
  // ...
}
```

3. **åˆ›å»ºé¡µé¢**:
```svelte
<!-- src/routes/(app)/case-studies/+page.svelte -->
<!-- ä½¿ç”¨ Picker ç»„ä»¶ + rich-content æ¸²æŸ“ -->
```

#### åŠ¨æ€åˆ†ç±»ç­›é€‰

é€šè¿‡ Schema çš„ `category` å­—æ®µå®ç°:

```typescript
const categories = [...new Set(practices.map(p => p.category))];

const filteredPractices = practices.filter(p =>
  selectedCategory === 'all' || p.category === selectedCategory
);
```

---

### 12.10 ä¼˜åŠ¿æ€»ç»“

| ä¼ ç»Ÿæ¶æ„ | Schema-Driven Architecture |
|---------|---------------------------|
| å†…å®¹è€¦åˆåœ¨ç»„ä»¶ä»£ç ä¸­ | å†…å®¹ä¸ä»£ç å®Œå…¨åˆ†ç¦» |
| æ›´æ–°å†…å®¹éœ€è¦é‡æ–°éƒ¨ç½² | åå°ç¼–è¾‘å³å¯ï¼Œå‰ç«¯è‡ªåŠ¨æ¸²æŸ“ |
| å¤šè¯­è¨€éœ€è¦å¤æ‚ i18n | åŸç”Ÿå¤šè¯­è¨€å­—æ®µæ”¯æŒ |
| å¯Œæ–‡æœ¬æ ·å¼ä¸ç»Ÿä¸€ | ç»Ÿä¸€çš„ `.rich-content` æ ·å¼ |
| CRUD éœ€è¦å‰åç«¯ååŒ | ç›´æ¥æ“ä½œ Schema æ•°ç»„ |
| éš¾ä»¥ç»´æŠ¤å’Œæ‰©å±• | æ¨¡å—åŒ–ã€æ˜“æ‰©å±• |

---

### 12.11 æœ€ä½³å®è·µ

1. **Schema First**: å…ˆå®šä¹‰ Schemaï¼Œå†å¼€å‘ç»„ä»¶
2. **å•ä¸€æ•°æ®æº**: æ‰€æœ‰åŠ¨æ€å†…å®¹éƒ½ä» Schema è¯»å–
3. **å­—æ®µå‘½åè§„èŒƒ**: ä¸¥æ ¼éµå¾ª `_zh`/`_en` åç¼€çº¦å®š
4. **å¯Œæ–‡æœ¬å‡€åŒ–**: ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ DOMPurify
5. **é”™è¯¯é™çº§**: API å¤±è´¥æ—¶è¿”å›ç©ºæ•°ç»„ï¼Œä¸ä¸­æ–­é¡µé¢æ¸²æŸ“
6. **ç±»å‹å®‰å…¨**: æ‰€æœ‰ Schema éƒ½æœ‰ TypeScript ç±»å‹å®šä¹‰
7. **æ–‡æ¡£åŒæ­¥**: Schema å˜æ›´æ—¶åŒæ­¥æ›´æ–°æ–‡æ¡£

---

**æœ€åæ›´æ–°**: 2025-11-11
**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
